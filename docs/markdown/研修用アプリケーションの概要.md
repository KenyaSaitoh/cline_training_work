# 研修用アプリケーションの概要

---

## 目次

1. **berry-books** - オンライン書店（顧客向け画面）
2. **berry-books-frontend** - オンライン書店（管理者画面）
3. **struts-to-jsf-person** - Person管理システム（レガシー）
4. **accounting_glue** - ERP会計統合ETL（Python）

---

## 1. berry-books - オンライン書店（顧客向け画面）

### 概要

Jakarta EE 10とJSF 4.0を使用したオンライン書店のWebアプリケーション（顧客向け画面）。書籍検索、ショッピングカート、注文処理などのEC機能を実装。

> **Note**: 管理者画面は別途`berry-books-frontend`（React SPA）として実装。データベースは両プロジェクトで共有。

### 採用技術

- **フレームワーク**: Jakarta EE 10（JSF 4.0, JPA 3.1, CDI 4.0）
- **サーバー**: Payara Server 6
- **データベース**: HSQLDB（**berry-books-frontendと共有**）
- **テスト**: JUnit 5 + Mockito

---

### システム構成

```
[Webブラウザ] ⇄ [Payara Server] ⇄ [HSQLDB（共有DB）]
              (berry-books.war)        ↑
              └─ JSF View              │
              └─ Managed Bean          │ 同じDBを使用
              └─ Service (CDI)         │
              └─ DAO (JPA)             ↓
              └─ Entity          (berry-books-rest.war)
                                 └─ 管理者画面用REST API
```

### 主な機能

- 書籍検索・閲覧（カテゴリ/キーワード検索）
- ショッピングカート（セッション管理）
- 注文処理（配送先入力、決済方法選択、在庫チェック）
- 注文履歴表示

---

### 研修レッスン

- **レッスン1**: 小規模改善
  - 決済方法のEnum化（マジックナンバー排除）
  - エラーメッセージのメッセージリソース化
  - 住所判定ロジックの共通化（ユーティリティクラス化）

- **レッスン2**: アーキテクチャガイドラインへの準拠チェック
  - ログ出力に統一感がないことを抽出
  - コーディング規約違反の検出

- **レッスン3**: 不具合修正
  - メールアドレスのバリデーション漏れ
  - 楽観的ロックのロジック不正

- **レッスン4**: 機能拡張
  - 在庫チェック機能の追加
  - 詳細設計書からの要件読み取り

- **レッスン5**: 単体テスト生成
  - 配送料金計算サービスの単体テスト作成（JUnit + Mockito）
  - ※仕様書通りに実装されていない不具合を発見する

---

## 2. berry-books-frontend - オンライン書店（管理者画面）

### 概要

Berry Booksオンライン書店の**管理者画面**。React + TypeScriptによるSPAとして実装。顧客向け画面（`berry-books`）とは別のアプリケーションだが、**同じデータベースを共有**。バックエンドはREST API（`berry-books-rest`）で連携。

> **Note**: 
> - 顧客向け画面: `berry-books`（JSF）
> - 管理者画面: `berry-books-frontend`（React SPA）
> - **データベースは両プロジェクトで共有**（HSQLDB）

### 採用技術

#### フロントエンド
- **フレームワーク**: React 18 + TypeScript 5
- **ビルドツール**: Vite 5
- **開発サーバー**: HMR対応

#### バックエンド（berry-books-rest）
- **フレームワーク**: Jakarta EE 10（JAX-RS 3.1, JSON-B 3.0）
- **サーバー**: Payara Server 6
- **データベース**: HSQLDB（**berry-booksと共有**）

---

### システム構成

```
[管理者（Webブラウザ）]
    ↓
[Vite Dev Server (React SPA)]
    ↓ REST API (JSON)
[Payara Server]
(berry-books-rest.war)
└─ JAX-RS Resource
└─ Service (CDI)
└─ DAO (JPA)
    ↓
[HSQLDB（共有DB）] ← berry-books（顧客向け）と同じDB
```

### 主な機能

- 顧客一覧表示（注文件数・購入冊数の統計情報含む）
- 顧客情報編集（インラインダイアログ、フォームバリデーション）

---

### 研修レッスン

- **レッスン6**: 仕様書からのスクラッチ開発（React）
  - REST API設計・実装（JAX-RS）
  - SPA開発（React + TypeScript）
  - フロントエンド/バックエンド連携

---

## 3. struts-to-jsf-person - Person管理システム（レガシーフレームワーク）

### 概要

レガシーなStruts 1.3.10を使用した人材管理システム。フレームワークマイグレーション（Struts → JSF）の研修課題として使用。

### 採用技術

- **フレームワーク**: Apache Struts 1.3.10（レガシー）
- **ビジネスロジック**: EJB 3.2（Stateless Session Bean）
- **データアクセス**: JDBC（PreparedStatement）
- **サーバー**: Apache TomEE 8
- **データベース**: HSQLDB

---

### システム構成

```
[Webブラウザ] ⇄ [TomEE 8] ⇄ [HSQLDB]
              (struts-person.war)
              └─ JSP + Strutsタグ
              └─ Action (Struts Controller)
              └─ ActionForm
              └─ EJB Service (@Stateless)
              └─ DAO (JDBC)
```

### 主な機能

- Person一覧表示
- Person追加・編集（入力→確認→登録の3画面遷移）
- Person削除

---

### 研修レッスン

- **レッスン7**: フレームワークのマイグレーション（Struts → JSF へのリライト）
  - Strutsタグライブラリの理解
  - レガシーコードの解析
  - モダンフレームワークへの移行

---

## 4. accounting_glue - ERP会計統合ETL（Python）

### 概要

上流システム（売上・人事・在庫）から会計パッケージへのデータ統合を行うETL処理。ローカル（開発）とAWS Glue（本番）の両方で実行可能。

### 採用技術

- **言語**: Python 3.11
- **実行エンジン**: PySpark（ローカル/AWS Glue）
- **データソース**: CSV（ファイルシステム/S3）
- **テスト**: pytest
- **並列処理**: ThreadPoolExecutor / Spark

---

### システム構成

#### ローカル環境
```
[test_data/]
├─ sales/*.csv
├─ hr/*.csv
└─ inventory/*.csv
    ↓ read CSV
[ETL Orchestrator]
├─ Sales ETL Job
├─ HR ETL Job
└─ Inventory ETL Job
    ↓ transform (共通Transformer)
[output/]
└─ accounting_txn_interface.csv（統合ファイル）
```

#### 本番環境（AWS）
```
[S3: input/]
    ↓
[AWS Glue Jobs（3ジョブ並列実行）]
    ↓ transform（ローカルと同じTransformer）
[S3: output/]
```

### 主な機能

- **Sales ETL**: 売上データ → 売掛金/売上高の仕訳生成
- **HR ETL**: 人事データ → 給料手当/未払費用の仕訳生成
- **Inventory ETL**: 在庫データ → 商品/売上原価の仕訳生成
- **並列処理**: 3つのETLジョブを同時実行
- **統合出力**: 会計パッケージ取込用の単一CSVファイル生成

---

### 研修レッスン

- **レッスン8**: 仕様書からのスクラッチ開発（PySpark/Glue）
  - ETL処理の設計・実装
  - データ変換ロジック（Transformer）
  - 単体テスト・統合テスト（pytest）
  - クラウド対応（AWS Glue）

---

## まとめ

| プロジェクト | 技術 | 画面 | 研修内容 |
|------------|------|------|---------|
| **berry-books** | Jakarta EE + JSF | 顧客向け | レッスン1-5: 小規模改善、ガイドライン準拠、不具合修正、機能拡張、単体テスト |
| **berry-books-frontend** | React + JAX-RS | 管理者向け（**DB共有**） | レッスン6: SPA開発（仕様書からのスクラッチ開発） |
| **struts-to-jsf-person** | Struts 1.x（レガシー） | - | レッスン7: フレームワークマイグレーション（Struts → JSF） |
| **accounting_glue** | Python + PySpark | - | レッスン8: ETL開発（仕様書からのスクラッチ開発） |
